<!--
  Miguel Larena
  Oct. 12, 2020
  COMP20
-->

<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Homework 9 - JSON Set List</title>
    <style media="screen">
      h1, h2 {
        font-family: "Trebuchet MS", Helvetica, sans-serif;
        text-align: center;
      }
      p {
        font-family: "Lucida Console", Courier, monospace;
        text-align: center;
        margin: 0;
      }
      body {
        text-align: center;
      }
      form {
        display: inline-block;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
      var xmlhttp = new XMLHttpRequest();
      xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          var jsonObj = JSON.parse(this.responseText);
          for (var i = 0; i < jsonObj.setlist.length; i++) {
            document.getElementsByTagName("h2")[i].innerHTML = jsonObj.setlist[i].name;
            var paragraph = document.getElementsByTagName("p")[i];
            paragraph.appendChild(document.createTextNode(jsonObj.setlist[i].artist));
            paragraph.appendChild(document.createElement("br"));
            paragraph.appendChild(document.createTextNode(jsonObj.setlist[i].genre));
            paragraph.appendChild(document.createElement("br"));
            paragraph.appendChild(document.createTextNode(jsonObj.setlist[i].year));
            paragraph.appendChild(document.createElement("br"));
          }
        }
      };
      xmlhttp.open("GET", "https://raw.githubusercontent.com/miguel-larena/comp20/hw9/setlist.json", true);
      xmlhttp.send();

      $(document).ready(function(){
        $("#filterForm").on("submit", function(e){
          e.preventDefault();
          $.ajax({url: "https://raw.githubusercontent.com/miguel-larena/comp20/hw9/setlist.json", success: function(result){
            var jsonString = JSON.parse(result);
            if ($('#genres').val() == "Default") {
              for (var j = 0; j < jsonString.setlist.length; j++) {
                document.getElementsByTagName("h2")[j].style.display = "block";
                document.getElementsByTagName("p")[j].style.display = "block";
              }
              return;
            }
            for (var j = 0; j < jsonString.setlist.length; j++) {
                 if ($('#genres').val() != jsonString.setlist[j].genre) {
                  document.getElementsByTagName("h2")[j].style.display = "none";
                  document.getElementsByTagName("p")[j].style.display = "none";
                } else {
                  document.getElementsByTagName("h2")[j].style.display = "block";
                  document.getElementsByTagName("p")[j].style.display = "block";
                }
            }
          }});
        });
      });
    </script>
  </head>

  <header>
    <h1>Tonight's Setlist!</h1>
  </header>

  <body>
    <form id="filterForm">
      <label for="genres">Filter By Genre:</label>
      <select id="genres" name="genres">
        <option selected value="Default">None</option>
        <option value="Electronic">Electronic</option>
        <option value="Hip-Hop/Rap">Hip-Hop/Rap</option>
        <option value="Pop">Pop</option>
        <option value="Rap">Rap</option>
      </select>
      <input type="submit" value="Filter">
    </form>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
    <h2></h2>
    <p></p>
  </body>
</html>
